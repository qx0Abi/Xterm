local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Xterm 0.0.1",
   Icon = 0,
   LoadingTitle = "Xterm",
   LoadingSubtitle = "by qx0_",
   ShowText = "Xterm",
   Theme = "Default",
   ToggleUIKeybind = "K",
   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false,
   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil,
      FileName = "Xterm"
   },
   Discord = {
      Enabled = false,
      Invite = "noinvitelink",
      RememberJoins = true
   },
   KeySystem = false,
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided",
      FileName = "Key",
      SaveKey = true,
      GrabKeyFromSite = false,
      Key = {"Hello"}
   }
})

local MainTab = Window:CreateTab("üè°Home", nil)
local MainSection = MainTab:CreateSection("Main")

Rayfield:Notify({
   Title = "Xterm 0.0.1",
   Content = "is Loading",
   Duration = 2,
   Image = nil,
})

local InfiniteJumpEnabled = false
local Button = MainTab:CreateButton({
   Name = "InfiniteJump",
   Callback = function()
       local UserInputService = game:GetService("UserInputService")
       local Players = game:GetService("Players")
       local LocalPlayer = Players.LocalPlayer

       InfiniteJumpEnabled = not InfiniteJumpEnabled

       if InfiniteJumpEnabled then
           if not _G.__XTERM_InfiniteJump_Conn then
               _G.__XTERM_InfiniteJump_Conn = UserInputService.JumpRequest:Connect(function()
                   if InfiniteJumpEnabled and LocalPlayer.Character then
                       local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                       if humanoid then
                           humanoid:ChangeState("Jumping")
                       end
                   end
               end)
           end
       else
           if _G.__XTERM_InfiniteJump_Conn and _G.__XTERM_InfiniteJump_Conn.Disconnect then
               _G.__XTERM_InfiniteJump_Conn:Disconnect()
               _G.__XTERM_InfiniteJump_Conn = nil
           end
       end
   end,
})

local noClipEnabled = false
local noClipLoopThread = nil
local characterAddedConn = nil

local function setCharacterCollisions(character, collide)
    if not character then return end
    for _, part in ipairs(character:GetDescendants()) do
        if part:IsA("BasePart") then
            part.CanCollide = collide
        end
    end
end

local function startNoClip()
    noClipEnabled = true
    local player = game.Players.LocalPlayer
    if player and player.Character then
        setCharacterCollisions(player.Character, false)
    end
    if not characterAddedConn then
        characterAddedConn = player.CharacterAdded:Connect(function(char)
            task.wait(0.1)
            if noClipEnabled then
                setCharacterCollisions(char, false)
            end
        end)
    end
    if not noClipLoopThread then
        noClipLoopThread = task.spawn(function()
            while noClipEnabled do
                local pl = game.Players.LocalPlayer
                local char = pl and pl.Character
                if char then
                    for _, part in ipairs(char:GetDescendants()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = false
                        end
                    end
                end
                task.wait(0.1)
            end
        end)
    end
end

local function stopNoClip()
    noClipEnabled = false
    if characterAddedConn then
        characterAddedConn:Disconnect()
        characterAddedConn = nil
    end
    local player = game.Players.LocalPlayer
    if player and player.Character then
        setCharacterCollisions(player.Character, true)
    end
end

local NoClipButton = MainTab:CreateButton({
   Name = "Toggle No Clip",
   Callback = function()
       if not noClipEnabled then
           startNoClip()
       else
           stopNoClip()
       end
   end,
})

local speedLoopEnabled = false
local jumpLoopEnabled = false
local speedLoopThread = nil
local jumpLoopThread = nil

local function getCurrentHumanoid()
    local pl = game.Players.LocalPlayer
    return pl and pl.Character and pl.Character:FindFirstChildOfClass("Humanoid") or nil
end

local currentHumanoid = getCurrentHumanoid()
local defaultWalkSpeed = currentHumanoid and currentHumanoid.WalkSpeed or 16
local defaultJumpPower = currentHumanoid and currentHumanoid.JumpPower or 50

local desiredWalkSpeed = defaultWalkSpeed
local desiredJumpPower = defaultJumpPower

local function startSpeedLoop()
    if speedLoopEnabled then return end
    speedLoopEnabled = true
    speedLoopThread = task.spawn(function()
        while speedLoopEnabled do
            local hm = getCurrentHumanoid()
            if hm and desiredWalkSpeed then
                hm.WalkSpeed = desiredWalkSpeed
            end
            task.wait(0.1)
        end
    end)
end

local function stopSpeedLoop()
    speedLoopEnabled = false
    speedLoopThread = nil
end

local function startJumpLoop()
    if jumpLoopEnabled then return end
    jumpLoopEnabled = true
    jumpLoopThread = task.spawn(function()
        while jumpLoopEnabled do
            local hm = getCurrentHumanoid()
            if hm and desiredJumpPower then
                hm.JumpPower = desiredJumpPower
            end
            task.wait(0.1)
        end
    end)
end

local function stopJumpLoop()
    jumpLoopEnabled = false
    jumpLoopThread = nil
end

local InputSpeed = MainTab:CreateInput({
   Name = "Speed",
   CurrentValue = tostring(defaultWalkSpeed),
   PlaceholderText = "Enter Number",
   RemoveTextAfterFocusLost = false,
   Flag = "InputSpeed",
   Callback = function(Text)
       local speedValue = tonumber(Text)
       if speedValue then
           desiredWalkSpeed = speedValue
           if not speedLoopEnabled then
               startSpeedLoop()
           end
       end
   end,
})

local InputJump = MainTab:CreateInput({
   Name = "Jump Height",
   CurrentValue = tostring(defaultJumpPower),
   PlaceholderText = "Enter Number",
   RemoveTextAfterFocusLost = false,
   Flag = "InputJump",
   Callback = function(Text)
       local jumpValue = tonumber(Text)
       if jumpValue then
           desiredJumpPower = jumpValue
           if not jumpLoopEnabled then
               startJumpLoop()
           end
       end
   end,
})

local ResetButton = MainTab:CreateButton({
    Name = "Reset Speed/Jump",
    Callback = function()
        stopSpeedLoop()
        stopJumpLoop()
        desiredWalkSpeed = defaultWalkSpeed
        desiredJumpPower = defaultJumpPower
        local hm = getCurrentHumanoid()
        if hm then
            hm.WalkSpeed = defaultWalkSpeed
            hm.JumpPower = defaultJumpPower
        end
        pcall(function()
            InputSpeed:SetValue(tostring(defaultWalkSpeed))
            InputJump:SetValue(tostring(defaultJumpPower))
        end)
    end,
})

local TeleportTab = Window:CreateTab("üß¨Teleports", nil)
local TeleportSection = TeleportTab:CreateSection("Teleport")

local function GetOnlinePlayers()
    local onlinePlayers = {}
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            table.insert(onlinePlayers, player.Name)
        end
    end
    return onlinePlayers
end

local function TeleportToPlayer(playerName)
    local player = game.Players:FindFirstChild(playerName)
    if player and player.Character and player.Character.PrimaryPart then
        local character = game.Players.LocalPlayer.Character
        if character and character.PrimaryPart then
            character:SetPrimaryPartCFrame(player.Character.PrimaryPart.CFrame)
        end
    end
end

local Dropdown = TeleportTab:CreateDropdown({
    Name = "Online Spieler",
    Options = GetOnlinePlayers(),
    CurrentOption = {GetOnlinePlayers()[1]},
    MultipleOptions = false,
    Flag = "Dropdown1",
    Callback = function(Options)
        TeleportToPlayer(Options[1])
    end,
})

game.Players.PlayerAdded:Connect(function()
    Dropdown:UpdateOptions(GetOnlinePlayers())
end)

game.Players.PlayerRemoving:Connect(function()
    Dropdown:UpdateOptions(GetOnlinePlayers())
end)

local ButtonX = TeleportTab:CreateButton({
   Name = "X",
   Callback = function()
       local pl = game.Players.LocalPlayer
       if pl and pl.Character and pl.Character:FindFirstChildOfClass("Humanoid") then
           pl.Character.Humanoid.JumpPower = 50000
       end
   end,
})
